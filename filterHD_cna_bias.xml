<tool id="filterHD_2" name="filterHD 2 - CNA with bias" version="0.1.0">

    <stdio>
        <exit_code range="1:" />
    </stdio>
	
	<requirements>
		<container type="docker">clonehd:smchet</container>
	</requirements>
	
	<command>
	<![CDATA[
	/opt/cloneHD/build/filterHD 
	--data ${cna} --mode ${mode} --pre ${sample_type}.cna.bias
	--bias ${bias} --sigma ${sigma} --jumps ${jumps}
	]]>
	</command>

	<inputs>
	    <param name="sample_type" type="select" label="Type of sample">
	        <option value="tumor">Tumor</option>
	        <option value="normal">Normal</option>
	    </param>
		<param format="tabular" name="cna" type="data" label="Read depth data file" help=""/>
		<param type="integer" name="mode" label="Mode" help="" value="3"/>
		<param format="tabular" name="bias" type="data" label="Bias data" help=""/>
		<param type="float" name="sigma" label="Diffusion constant sigma" help="" value="0"/>
		<param type="float" name="jumps" label="Jump probability" help="" value="1"/>
	</inputs>

	<outputs>
	    <data format="tabular" name="cna_jumps" type="data" label="tumor.cna.bias.jumps.txt" >
	        <filter>sample_type == "tumor"</filter>
        </data>
	    <data format="tabular" name="cna_jumps" type="data" label="normal.cna.bias.jumps.txt" >
	        <filter>sample_type == "normal"</filter>
	    </data>
	    <data format="tabular" name="cna_posterior" type="data" label="tumor.cna.bias.posterior-1.txt" >
	        <filter>sample_type == "tumor"</filter>
        </data>
	    <data format="tabular" name="cna_posterior" type="data" label="normal.cna.bias.posterior-1.txt" >
	        <filter>sample_type == "normal"</filter>
	    </data>
	</outputs>

	<help>
	  The tumor read depth is now analysed with the bias field from the matched normal. The diffusion constant is set to zero. 
	  If left free, it should converge to a very small value. The jump rate could be slightly higher. The LLH should be higher than
	  for the run above indicating the presence of the bias field. Now we are interested in the jumps.
	</help>

</tool>

