<tool id="cloneHD_input" name="cloneHD - Tool Input Prep" version="0.1.0">
  <stdio>
    <exit_code range="1:" />
  </stdio>
  <requirements>
    <container type="docker">clonehd:smchet</container>
  </requirements>
  <command>
    <![CDATA[
    python /opt/cloneHD-tools/clonehd/snv_parser.py
    --output-snvs ${output_snvs}
    --variant-type ${snv_type}
    ${vcf_file};
	perl /opt/cloneHD-tools/clonehd/convert-Battenberg-to-cloneHD-prior-v3.pl
    -g "male"
	-m "mean-tcn"
	-c ${cna_file}
    -o ${output_mean_tcn}
	perl /opt/cloneHD-tools/clonehd/convert-Battenberg-to-cloneHD-prior-v3.pl
	-g "male"
	-m "avail-cn"
	-c ${cna_file}
	-o ${output_avail_cn}
    ${cna_file}
    ]]>
  </command>
  <inputs>
        <param name="cna_type" type="select" value="" label="CNA type" help="Select the input type for copy number.">
            <option value="battenberg-smchet" selected="True">Battenberg</option>
        </param>
        <param name="cna_file" type="data" format="tabular" optional="false" label="CNA prior" help="Set the CNA prior from a Battenberg file."/>
	<!-- <param name="cellularity_ploidy" type="data" format="tabular" optional="false" label="Cellularity-ploidy" help="Cellularity-ploidy from Battenberg file."/>
	<!-- <param name="cellularity" type="float" value="1.0" label="Cellularity" /> -->
	<!-- <param name="cellularity" type="select" data_ref="cellularity_ploidy" dynamic_options="get_options(cellularity_ploidy, cellularity)" label="Cellularity" help=""/> -->
        <param name="only_normal_cn" type="boolean" label="Only report CN regions" help="Only output variants lying in normal CN regions. Do not output CNA data directly."/>
        <param name="snv_type" type="select" label="SNV type">
            <option value="mutect_smchet" selected="True">MuTect</option>
        </param>
        <param name="vcf_file" type="data" format="vcf" label="Variant file" help="Select the variant file in VCF format."/>
	<param name="gender" type="select" label="Gender" help="">
            <option value="male" selected="True">Male</option>
            <option value="female" selected="False">Female</option>
	</param>
  </inputs>
  <outputs>
        <data format="tabular" name="output_mean_tcn" label="Mean total copy number for cloneHD"/>
	<data format="tabular" name="output_avail_cn" label="Available copy number for cloneHD"/>
        <data format="tabular" name="output_snvs" label="SNVs for cloneHD"/>
  </outputs>
  <help>
	  Create cloneHD/filterHD input from VCFs and Battenberg calls.
  </help>
</tool>
