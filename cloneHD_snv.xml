<tool id="cloneHD_2" name="cloneHD 2 - SNV" version="0.1.0">

    <stdio>
        <exit_code range="1:" />
    </stdio>
	
	<requirements>
		<container type="docker">clonehd:smchet</container>
	</requirements>
	
	<command>
	<![CDATA[
	export OMP_NUM_THREADS=\${GALAXY_SLOTS:-1};
	/opt/cloneHD/build/cloneHD 
	--pre sample
	--snv ${snv}
	--seed ${seed}
	--trials ${trials}
	--force ${n_clones}
	--max-tcn ${max_tcn} 
	--restarts ${restarts} 
	--mean-tcn ${mean_tcn}
	--avail-cn ${avail_cn}
	--snv-rnd ${snv_rnd}
	--snv-fpfreq ${snv_fpfreq}
	--snv-fprate ${snv_fprate}
	--learn-cluster-w ${learn_cluster_w}
	--snv-pen-high ${snv_pen_high}
	--print-all ${verbose}
	> ${solution}
	]]>
	</command>

	<inputs>
		<param name="seed" type="integer" label="Seed" help="" value="123" optional="true"/>
		<param name="trials" type="integer" label="The number of independent optimizations" help="" value="3" optional="true"/>
		<param name="n_clones" type="integer" label="Force number of subclones" help="" value="1"/>
		<param name="max_tcn" type="integer" label="The maximum total copy number to be available" help="" value="8"/>
		<param name="restarts" type="integer" label="The number of perturbations in local random search mode" help="" value="3" optional="true"/>
		<param format="tabular" name="mean_tcn" type="data" label="Use a fixed mean total copy number for SNV data" help=""/>
		<param format="tabular" name="avail_cn" type="data" label="Use SNV copy number availablility constraint" help=""/>
		<param format="tabular" name="snv" type="data" label="Somatic nucleotide variant read count data file" help=""/>
                <param name="snv_pen_tree" type="float" label="SNV penalty tree" help="" value="1E-3"/>
		<param name="snv_rnd" type="float" label="SNV error rate" help="" value="1E-2"/>
		<param name="snv_fpfreq" type="float" label="SNV false positive freq" help="" value="5E-2"/>
		<param name="snv_fprate" type="float" label="SNV false positive rate" help="" value="5E-2"/>
		<param name="learn_cluster_w" type="integer" label="Learn cluster weights" help="" value="1"/>
		<param name="snv_pen_high" type="float" label="SNV penalty high" help="" value="3E-1"/>
		<param name="verbose" type="integer" label="Verbosity of output" help="" value="0"/>
	</inputs>
	<outputs>
	        <data format="text" name="solution" type="data" label="Model solution"/>
	        <data format="tabular" name="margin_map" type="data" label="Margin map" from_work_dir="sample.margin_map.txt"/>
	        <data format="tabular" name="snv_posterior" type="data" label="SNV posterior" from_work_dir="sample.snv.posterior.txt"/>
		<data format="tabular" name="snv_subclone" type="data" label="SNV subclone" from_work_dir="sample.snv.subclone-1.txt"/>
		<data format="tabular" name="snv_used_mean_tcn" type="data" label="Mean total copy number used" from_work_dir="sample.snv.used-mean-tcn.txt"/>
		<data format="tabular" name="summary" type="data" label="Summary" from_work_dir="sample.summary.txt"/>
		<data format="text" name="solution" type="data" label="Model solution"/>
		<!-- <data format="txt" name="report"> -->
		<!--   <discover_datasets pattern="(?P&lt;designation&gt;.+)\.margin_map\.txt" type="data" ext="tabular" visible="true" label="Margin map" /> -->
		<!--   <discover_datasets pattern="(?P&lt;designation&gt;.+)\.snv_posterior\.txt" type="data" ext="tabular" visible="true" label="SNV posterior" /> -->
		<!--   <discover_datasets pattern="(?P&lt;designation&gt;.+)\.snv_subclone\.txt" type="data" ext="tabular" visible="true" label="SNV subclone" /> -->
		<!--   <discover_datasets pattern="(?P&lt;designation&gt;.+)\.snv_used_mean_tcn\.txt" ext="tabular" visible="true" label="Mean total copy number used" /> -->
		<!--   <discover_datasets pattern="(?P&lt;designation&gt;.+)\.summary\.txt" ext="tabular" visible="true" label="Summary" /> -->
		<!-- </data> -->
	</outputs>
	
	<help>
	   Using the subclonality analysis with CNA and BAF data, the SNV data is analysed.
	</help>

</tool>
