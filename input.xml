<tool id="cloneHD_Tool_Input_Prep" name="cloneHD - Tool Input Prep" version="0.1.0">
  <stdio>
    <exit_code range="1:" />
  </stdio>
  <requirements>
    <container type="docker">clonehd:smchet</container>
  </requirements>
  <command>
    <![CDATA[
    python /opt/cloneHD-tools/clonehd/clonehd.py 
    #if $subsample.run == "yes":
    --sample-size ${subsample.count}
    #end if
    #if $only_normal_cn
    --only-normal-cn 
    #end if
    --cnas ${cnas}
    --output-cnas ${output_cnas}
    --output-snvs ${output_snvs}
    --variant-type ${input_type}
    --cna-confidence ${cna_confidence}
    --read-length ${read_length}
    ${vcf_file}
    ]]>
  </command>
  <inputs>
        <conditional name="subsample">
            <param name="run" label="Run Subsampling" type="select" help="Subsample SNVs to reduce cloneHD runtime">
                <option value="yes">Yes</option>
                <option value="no" selected="True">No</option>
            </param>
            <when value="yes">
                <param name="count" type="integer" label="Subsample Size" help="Subsample reported number of SNVs" value="0"/>
            </when>
        </conditional>
        <param name="cnas" type="data" format="tabular" optional="false" help="CNAs extracted from Battenberg file using cloneHD CNAs Prep"/>
        <param name="only_normal_cn" type="boolean" label="Only report CN regions" help="Only output variants lying in normal CN regions. Do not output CNA data directly."/>
        <param name="input_type" value="Variant Input Type" type="select">
            <option value="mutect_smchet" selected="True">MuTect</option>
        </param>
        <param name="cna_confidence" type="float" help="Confidence in CNAs. Set to &lt; 1 to scale 'd' values" value="1.0"/>
        <param name="read_length" type="integer" help="Approximate length of reads. Used to calculate confidence in CNA frequencies (default: 100)" value="100"/>
        <param name="vcf_file" type="data" format="vcf" help="Variant File"/>
  </inputs>
  <outputs>
        <data format="tabular" name="output_cnas" label="CNAs for cloneHD tool"/>
        <data format="tabular" name="output_snvs" label="SNVs for cloneHD tool"/>
  </outputs>
  <help>
	  <![CDATA[- Second tool to be executed when using the cloneHD example.]]>
    &#xA;<![CDATA[- Extracts SNVs from a VCF file and formats CNAs from a CNA text file.]]>
    &#xA;<![CDATA[- More information on this tool can be found at https://github.com/ivazquez/cloneHD-tools/tree/master/clonehd/clonehd.py under clonehd.py]]> 
    &#xA;<![CDATA[- Output from this tool will be used in cloneHD 3 - Tool]]>
	</help>
</tool>
