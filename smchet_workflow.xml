<tool id="cloneHD_workflow" name="cloneHD workflow" version="0.1.0">
	
	<stdio>
		<exit_code range="1:" />
	</stdio>
	
	<requirements>
		<container type="docker">clonehd:smchet</container>
	</requirements>
	
	<command>
	<![CDATA[
	export OMP_NUM_THREADS=\${GALAXY_SLOTS:-1};
	smchet_workflow.sh
	--sample sample
	--vcf ${snv_file}
	--cna ${cna_file}
	--seed ${seed}
	--trials ${trials}
	--force ${n_clones}
	--max-tcn ${max_tcn}
	--restarts ${restarts}
	--snv-rnd ${snv_rnd}
	--snv-fpfreq ${snv_fpfreq}
	--snv-fprate ${snv_fprate}
	--snv-pen-high ${snv_pen_high}
	]]>
	</command>

	<inputs>
		<param name="cna_file" type="data" format="tabular" optional="false" label="CNA prior file" help="Set the CNA prior from a Battenberg file."/>
		<param name="snv_file" type="data" format="vcf" label="Variant file" help="Select the variant file in VCF format."/>
		<param name="seed" type="integer" label="Seed" help="" value="123" optional="true"/>
		<param name="trials" type="integer" label="The number of independent optimizations" help="" value="3" optional="true"/>
		<param name="max_tcn" type="integer" label="The maximum total copy number to be available" help="" value="8" optional="true"/>
		<param name="restarts" type="integer" label="The number of perturbations in local random search mode" help="" value="3" optional="true"/>
		<param name="snv_pen_tree" type="float" label="SNV penalty tree" help="" value="1E-3" optional="true"/>
		<param name="snv_rnd" type="float" label="SNV error rate" help="" value="1E-2" optional="true"/>
		<param name="snv_fpfreq" type="float" label="SNV false positive freq" help="" value="5E-2" optional="true"/>
		<param name="snv_fprate" type="float" label="SNV false positive rate" help="" value="5E-2" optional="true"/>
		<param name="snv_pen_high" type="float" label="SNV penalty high" help="" value="3E-1" optional="true"/>
	</inputs>

	<outputs>
		<data format="txt" name="cellularity" label="Cellularity (Sub Challenge 1A)" from_work_dir="sample.1A.txt"/>
		<data format="txt" name="no_clusters" label="Number Clusters (Sub Challenge 1B)" from_work_dir="sample.1B.txt"/>
		<data format="txt" name="proportions" label="Cluster Proportions (Sub Challenge 1C)" from_work_dir="sample.1C.txt"/>
		<data format="txt" name="assignments" label="Cluster Assignments (Sub Challenge 2A)" from_work_dir="sample.2A.txt"/>
		<data format="binary" name="co_clustering" label="Co-Cluster (Sub Challenge 2B)" from_work_dir="sample.2B.txt.gz"/>
	</outputs>
	
	<help>
	   Using the subclonality analysis with CNA and BAF data, the SNV data is analysed.
	</help>

</tool>
