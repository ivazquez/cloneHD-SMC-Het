<tool id="cloneHD_1" name="cloneHD 1 - CNA+BAF" version="0.1.0">

    <stdio>
        <exit_code range="1:" />
    </stdio>
	
	<requirements>
		<container type="docker">clonehd:smchet</container>
	</requirements>
	
	<command>
	<![CDATA[
	/opt/cloneHD/build/cloneHD 
	--cna ${cna} --baf ${baf} --pre tumor
	--bias ${bias} --seed 123 --trials ${trials}
	--nmax ${nmax} --force --max-tcn ${max_tcn} 
	--cna-jumps ${cna_jumps} --baf-jumps ${baf_jumps}
	--min-jump ${min_jump} --restarts ${restarts} --mass-gauging ${mass_gauging}
	]]>
	</command>

	<inputs>
		<param format="tabular" name="cna" type="data" label="Read depth data file" help="" />
		<param format="tabular" name="baf" type="data" label="B-allele read count data file" help="" />
		<param format="tabular" name="bias" type="data" label="The bias field for the read depth data" help="" />
        <param format="tabular" name="cna_jumps" type="data" label="CNA jumps file" help=""/>
        <param format="tabular" name="baf_jumps" type="data" label="BAF jumps file" help=""/>
		<param name="trials" type="integer" label="The number of independent optimizations" help="" value="10"/>
		<param name="nmax" type="integer" label="The maximum number of subclones to be tried" help="" value="3"/>
		<param name="max_tcn" type="integer" label="The maximum total copy number to be available" help="" value="4"/>
		<param name="min_jump" type="float" label="Jump probability threshold" help="" value="1E-2" optional="true"/>
		<param name="restarts" type="integer" label="The number of perturbations in local random search mode" help="" value="10" optional="true"/>
		<param name="mass_gauging" type="integer" label="Mass gauging" help="" value="1"/>
	</inputs>

	<outputs>
		<data format="tabular" name="mean_tcn" type="data" label="tumor.mean-tcn.txt"/>
		<data format="tabular" name="avail_cn" type="data" label="tumor.avail-cn.txt"/>
		<data format="tabular" name="baf_gof" type="data" label="tumor.baf.gof.txt"/>
		<data format="tabular" name="baf_posterior" type="data" label="tumor.baf.posterior.txt"/>
		<data format="tabular" name="baf_subclone" type="data" label="tumor.baf.subclone.txt"/>
		<data format="tabular" name="baf_used_mean_tcn" type="data" label="tumor.baf.used-mean-tcn.txt"/>
		<data format="tabular" name="cna_gof" type="data" label="tumor.cna.gof.txt"/>
		<data format="tabular" name="cna_posterior" type="data" label="tumor.cna.posterior.txt"/>
		<data format="tabular" name="cna_subclone" type="data" label="tumor.cna.subclone.txt"/>
		<data format="tabular" name="margin_map" type="data" label="tumor.margin_map.txt"/>
		<data format="tabular" name="summary" type="data" label="tumor.summary.txt"/>
		<!--<data format="tabular" name="mean_tcn" type="data" label="mean total copy number" from_work_dir="tumor.mean-tcn.txt"/>-->
		<!--<data format="tabular" name="avail_cn" type="data" label="available copy number" from_work_dir="tumor.avail-cn.txt"/>-->
		<!--<data format="tabular" name="baf_gof" type="data" label="baf goodness-of-fit" from_work_dir="tumor.baf.gof.txt"/>-->
		<!--<data format="tabular" name="baf_posterior" type="data" label="baf posterior" from_work_dir="tumor.baf.posterior.txt"/>-->
		<!--<data format="tabular" name="baf_" type="data" label="baf subclone" from_work_dir="tumor.baf.subclone.txt"/>-->
		<!--<data format="tabular" name="baf_used_mean_tcn" type="data" label="baf used mean total copy number" from_work_dir="tumor.baf.used-mean-tcn.txt"/>-->
		<!--<data format="tabular" name="cna_gof" type="data" label="cna goodness-of-fit" from_work_dir="tumor.cna.gof.txt"/>-->
		<!--<data format="tabular" name="cna_posterior" type="data" label="cna posterior" from_work_dir="tumor.cna.posterior.txt"/>-->
		<!--<data format="tabular" name="cna_subclone" type="data" label="cna subclone" from_work_dir="tumor.cna.subclone.txt"/>-->
		<!--<data format="tabular" name="margin_map" type="data" label="Margin map" from_work_dir="tumor.margin_map.txt"/>-->
		<!--<data format="tabular" name="summary" type="data" label="Summary" from_work_dir="tumor.summary.txt"/>-->
	</outputs>

	<help>
	    The CNA and BAF data is analysed for subclonality.
	    Try varying the --min-jump, --force and --max-tcn values and try --mass-gauging 0. 
	    Try adding the SNV data to the mix.
	</help>

</tool>